Question:

From the 2011 South African Junior Olympiad:

Several people line up in single file.
A solitary latecomer wishes to join the queue.
Prove that it is always possible for them to join the line somewhere
so that the number of men in front of them is equal to the number of women behind them.

Warning:

I use position as a synonym for index, where indices start from 0.
This implies that position n has n positions before it.

Notation:

#ws = number of women

wpa = woman position after him

wpas = woman positions after him

mpb = man position before him

mpbs = man positions before him

Proposition:

The position p for the latecomer to join is the one with #ws persons before him.

Proof:

The proof follows from the lemma below.

Lemma:

When at position p, there is a bijection from wpas to mbps.

Proof (by contradiction):

Assume that there is no function from wpas to mbps.

This implies that there is a wpa without a mbp.
In that case there would be too many women.

We can conclude that there is a function from wpas to mbps.

Assume that the function is not an injection from wpas to mbps.

This implies that there are two wpas mapped on one mbp.
In that case there would be too many women.

We can conclude that there is an injection from wpas to mbps.

Assume that the injection is not an surjection from wpas to mbps.
Let mbps' consist of the 

In that case there are more than #ws persons before him. 

qed